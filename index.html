<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KidoPilot OS | Executive Demo</title>
    
    <!-- React Stack -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Plus+Jakarta+Sans:wght@500;600;700;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Plus Jakarta Sans', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            navy: '#0B2438',
                            teal: '#0D9488',
                            tealLight: '#F0FDFA',
                            accent: '#F97316',
                            surface: '#F8FAFC',
                            border: '#E2E8F0'
                        }
                    },
                    animation: {
                        'slide-up': 'slideUp 0.4s ease-out forwards',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 5px; height: 5px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 3px; }
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.5); }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 antialiased overflow-hidden selection:bg-brand-teal selection:text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- INLINE ICONS (ZERO DEPENDENCY) ---
        // SVGs intégrés pour garantir l'affichage à 100% sans script externe
        const Icons = {
            Menu: <path d="M4 6h16M4 12h16M4 18h16" />,
            LayoutGrid: <rect width="7" height="7" x="3" y="3" rx="1" /><rect width="7" height="7" x="14" y="3" rx="1" /><rect width="7" height="7" x="14" y="14" rx="1" /><rect width="7" height="7" x="3" y="14" rx="1" />,
            CalendarClock: <path d="M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5" /><path d="M16 2v4" /><path d="M8 2v4" /><path d="M3 10h5" /><path d="M17.5 17.5 16 16.25V14" /><circle cx="16" cy="16" r="6" />,
            Users: <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" /><circle cx="9" cy="7" r="4" /><path d="M22 21v-2a4 4 0 0 0-3-3.87" /><path d="M16 3.13a4 4 0 0 1 0 7.75" />,
            FileCheck: <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" /><polyline points="14 2 14 8 20 8" /><path d="m9 15 2 2 4-4" />,
            Coins: <circle cx="8" cy="8" r="6" /><path d="M18.09 10.37A6 6 0 1 1 10.34 18" /><path d="M7 6h1v4" /><path d="m16.71 13.88.7 .71-2.82 2.82" />,
            Bell: <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9" /><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0" />,
            Search: <circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" />,
            AlertTriangle: <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" /><path d="M12 9v4" /><path d="M12 17h.01" />,
            BrainCircuit: <path d="M12 4.5a2.5 2.5 0 0 0-4.96-.46 2.5 2.5 0 0 0-1.98 3 2.5 2.5 0 0 0-1.32 4.24 3 3 0 0 0 .34 5.58 2.5 2.5 0 0 0 2.96 3.08 2.5 2.5 0 0 0 4.91.05L12 20V4.5Z" /><path d="M16 8V5c0-1.1.9-2 2-2" /><path d="M12 13h4" /><path d="M12 18h6a2 2 0 0 1 2 2v1" /><path d="M12 8h8" />,
            CheckCircle2: <circle cx="12" cy="12" r="10" /><path d="m9 12 2 2 4-4" />,
            Clock: <circle cx="12" cy="12" r="10" /><polyline points="12 6 12 12 16 14" />,
            TrendingUp: <polyline points="22 7 13.5 15.5 8.5 10.5 2 17" /><polyline points="16 7 22 7 22 13" />,
            DollarSign: <line x1="12" x2="12" y1="2" y2="22" /><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />,
            ArrowRight: <path d="M5 12h14" /><path d="m12 5 7 7-7 7" />,
            ChevronDown: <path d="m6 9 6 6 6-6" />,
            Sparkles: <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275Z" />
        };

        const Icon = ({ name, className = "", size = 20 }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {Icons[name] || <circle cx="12" cy="12" r="10" />}
            </svg>
        );

        // --- COMPONENTS ---

        const Toast = ({ message, type, onClose }) => {
            useEffect(() => {
                const timer = setTimeout(onClose, 3000);
                return () => clearTimeout(timer);
            }, []);

            const bgClass = type === 'success' ? 'bg-brand-navy text-white' : 'bg-white text-slate-800 border border-slate-200';
            
            return (
                <div className={`fixed bottom-6 right-6 z-[60] px-6 py-4 rounded-xl shadow-2xl flex items-center gap-4 animate-slide-up ${bgClass}`}>
                    <Icon name={type === 'success' ? "CheckCircle2" : "Sparkles"} className={type === 'success' ? "text-brand-teal" : "text-brand-accent"} />
                    <span className="font-medium">{message}</span>
                </div>
            );
        };

        const SidebarItem = ({ icon, label, active, onClick, alert }) => (
            <button 
                onClick={onClick}
                className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 group ${active ? 'bg-brand-teal/10 text-brand-teal font-bold' : 'text-slate-500 hover:bg-slate-100'}`}
            >
                <Icon name={icon} className={active ? 'text-brand-teal' : 'text-slate-400 group-hover:text-slate-600'} size={20} />
                <span className="flex-1 text-left text-sm">{label}</span>
                {alert && <span className="w-2 h-2 rounded-full bg-brand-accent animate-pulse-slow"></span>}
            </button>
        );

        const KPI = ({ title, value, unit, trend, icon, color }) => (
            <div className="bg-white p-4 lg:p-5 rounded-2xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow">
                <div className="flex justify-between items-start mb-4">
                    <div className={`p-2 rounded-lg ${color}`}>
                        <Icon name={icon} size={20} />
                    </div>
                    {trend && (
                        <span className="text-[10px] lg:text-xs font-bold text-green-600 bg-green-50 px-2 py-1 rounded-full flex items-center">
                            <Icon name="TrendingUp" size={12} className="mr-1" /> {trend}
                        </span>
                    )}
                </div>
                <p className="text-slate-500 text-[10px] lg:text-xs font-bold uppercase tracking-wider">{title}</p>
                <p className="text-xl lg:text-2xl font-display font-bold text-brand-navy mt-1">{value}<span className="text-sm text-slate-400 font-normal ml-1">{unit}</span></p>
            </div>
        );

        // --- VIEWS ---

        const DashboardView = ({ stats, alerts, onFixAlert }) => (
            <div className="space-y-6 animate-slide-up pb-20 lg:pb-0">
                {/* Header Context */}
                <div className="flex flex-col md:flex-row justify-between items-start md:items-end gap-4">
                    <div>
                        <h2 className="text-2xl font-display font-bold text-brand-navy">Vue d'ensemble</h2>
                        <p className="text-slate-500 text-sm">Mardi 2 Décembre • Crèche "Les Petits Pas"</p>
                    </div>
                    <div className="flex gap-2">
                        <button className="bg-white border border-slate-200 text-slate-600 px-4 py-2 rounded-lg text-sm font-medium hover:bg-slate-50 hidden sm:block">Exporter</button>
                    </div>
                </div>

                {/* Alerts Section (The Hook) */}
                {alerts.length > 0 && (
                    <div className="bg-orange-50/50 border border-orange-100 rounded-2xl p-4 lg:p-6 relative overflow-hidden">
                        <div className="flex flex-col md:flex-row gap-4 items-start md:items-center justify-between relative z-10">
                            <div className="flex gap-4">
                                <div className="bg-white p-3 rounded-xl shadow-sm text-brand-accent">
                                    <Icon name="AlertTriangle" />
                                </div>
                                <div>
                                    <h3 className="font-bold text-brand-navy text-lg">Attention requise (IA)</h3>
                                    <p className="text-slate-600 text-sm max-w-md mt-1">
                                        Sous-effectif critique détecté pour cet après-midi (14h-16h) suite à l'absence déclarée de Julie D.
                                    </p>
                                </div>
                            </div>
                            <button 
                                onClick={onFixAlert}
                                className="w-full md:w-auto bg-brand-accent text-white px-6 py-3 rounded-xl font-bold shadow-lg shadow-orange-500/20 hover:shadow-orange-500/30 transition-all active:scale-95 flex items-center justify-center gap-2"
                            >
                                <Icon name="BrainCircuit" size={18} />
                                Optimiser le Planning
                            </button>
                        </div>
                    </div>
                )}

                {/* KPIs Grid */}
                <div className="grid grid-cols-2 lg:grid-cols-4 gap-3 lg:gap-4">
                    <KPI title="Taux d'occupation" value={stats.occupancy} unit="%" trend="+2.4%" icon="Users" color="bg-blue-50 text-blue-600" />
                    <KPI title="Ratio Encadrement" value={`1:${stats.ratio}`} unit="E/P" icon="Users" color={stats.ratio > 6 ? "bg-red-50 text-red-600" : "bg-teal-50 text-brand-teal"} />
                    <KPI title="Masse Salariale" value={(stats.payroll / 1000).toFixed(1)} unit="k€" trend="-1.2%" icon="DollarSign" color="bg-purple-50 text-purple-600" />
                    <KPI title="Conformité" value={stats.compliance} unit="/100" icon="FileCheck" color="bg-green-50 text-green-600" />
                </div>

                {/* Simple Chart Visualization */}
                <div className="bg-white rounded-2xl border border-slate-200 p-6 shadow-sm">
                    <div className="flex justify-between items-center mb-6">
                        <h3 className="font-bold text-brand-navy">Évolution des Présences</h3>
                        <div className="flex gap-2">
                             <div className="flex items-center gap-1 text-xs text-slate-500"><div className="w-2 h-2 rounded-full bg-brand-teal"></div> Réel</div>
                             <div className="flex items-center gap-1 text-xs text-slate-500"><div className="w-2 h-2 rounded-full bg-slate-200"></div> Prévu</div>
                        </div>
                    </div>
                    <div className="h-48 flex items-end justify-between gap-2 px-2">
                         {[65, 75, 94, 88, 70, 85, 90].map((h, i) => (
                            <div key={i} className="w-full flex flex-col gap-2 group cursor-pointer h-full justify-end">
                                <div className="w-full bg-slate-100 rounded-t-lg relative overflow-hidden" style={{height: '100%'}}>
                                    <div style={{height: `${h}%`}} className="absolute bottom-0 w-full bg-brand-teal group-hover:bg-brand-navy transition-all duration-500 rounded-t-lg"></div>
                                </div>
                                <span className="text-center text-[10px] text-slate-400 font-medium">J{i+1}</span>
                            </div>
                         ))}
                    </div>
                </div>
            </div>
        );

        const PlanningView = ({ staff, alerts, onFixAlert }) => (
            <div className="space-y-4 lg:space-y-6 animate-slide-up h-full flex flex-col pb-20 lg:pb-0">
                <div className="flex justify-between items-center">
                    <h2 className="text-xl lg:text-2xl font-display font-bold text-brand-navy">Planning Intelligent</h2>
                    <div className="flex gap-2">
                         <button className="bg-white border border-slate-200 px-3 py-2 rounded-lg text-sm font-bold text-brand-navy">
                            Aujourd'hui
                        </button>
                    </div>
                </div>

                <div className="flex-1 bg-white rounded-2xl border border-slate-200 shadow-sm flex flex-col overflow-hidden relative">
                    {/* Time Header */}
                    <div className="hidden md:flex h-12 border-b border-slate-100 items-center pl-48 pr-4">
                        {[8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18].map(h => (
                            <div key={h} className="flex-1 text-xs text-slate-400 font-medium border-l border-slate-100 pl-2">
                                {h}:00
                            </div>
                        ))}
                    </div>

                    {/* Timeline Body */}
                    <div className="flex-1 overflow-y-auto p-4 space-y-4">
                        {staff.map(person => (
                            <div key={person.id} className="flex flex-col md:flex-row md:items-center gap-2 md:gap-0 group">
                                <div className="w-full md:w-48 pr-4 flex items-center gap-3">
                                    <div className="w-8 h-8 rounded-full bg-brand-navy text-white flex items-center justify-center text-xs font-bold">
                                        {person.avatar}
                                    </div>
                                    <div>
                                        <p className="font-bold text-brand-navy text-sm">{person.name}</p>
                                        <p className="text-xs text-slate-500">{person.role}</p>
                                    </div>
                                </div>
                                <div className="w-full md:flex-1 h-10 md:h-12 bg-slate-50 rounded-xl relative border border-slate-100 overflow-hidden">
                                    {/* The Shift Block */}
                                    {person.status === 'present' && (
                                        <div 
                                            className="absolute top-1 bottom-1 bg-brand-teal/20 border border-brand-teal text-brand-teal text-[10px] md:text-xs font-bold rounded-lg flex items-center justify-center whitespace-nowrap px-2"
                                            style={{ left: '0%', width: '100%' }} // Simplified for demo
                                        >
                                            <Icon name="Clock" size={12} className="mr-1 hidden md:block" />
                                            {person.shift}
                                        </div>
                                    )}
                                    
                                    {/* The Problem Block */}
                                    {person.status === 'absent' && (
                                        <div 
                                            className="absolute top-1 bottom-1 bg-red-50 border border-red-200 text-red-500 text-xs font-bold rounded-lg flex items-center justify-center w-full"
                                        >
                                            <Icon name="AlertTriangle" size={14} className="mr-2" />
                                            Absence Non Remplacée
                                        </div>
                                    )}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>

                {/* AI Action Panel (Bottom) */}
                {alerts.length > 0 && (
                    <div className="bg-brand-navy text-white p-4 rounded-xl flex flex-col md:flex-row justify-between items-center shadow-lg gap-4">
                        <div className="flex items-center gap-4">
                            <div className="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center animate-pulse-slow">
                                <Icon name="BrainCircuit" className="text-brand-accent" />
                            </div>
                            <div>
                                <p className="font-bold text-sm">Solution trouvée par l'IA</p>
                                <p className="text-xs text-slate-300">Remplacement par C. Dupont (Vacataire) disponible.</p>
                            </div>
                        </div>
                        <button 
                            onClick={onFixAlert}
                            className="w-full md:w-auto bg-brand-teal hover:bg-teal-600 text-white px-6 py-2 rounded-lg font-bold text-sm transition-colors"
                        >
                            Valider (+85€)
                        </button>
                    </div>
                )}
            </div>
        );

        // --- MAIN APP SHELL ---

        const App = () => {
            const [view, setView] = useState('dashboard');
            const [alerts, setAlerts] = useState(['understaffed']);
            const [stats, setStats] = useState({ occupancy: 94, ratio: 6.2, payroll: 32450, compliance: 92 });
            const [staff, setStaff] = useState([
                { id: 1, name: 'Marie L.', role: 'EJE', shift: '08:00 - 16:00', status: 'present', avatar: 'M' },
                { id: 2, name: 'Sarah B.', role: 'AP', shift: '08:30 - 17:00', status: 'present', avatar: 'S' },
                { id: 3, name: 'Julie D.', role: 'CAP', shift: '09:00 - 18:00', status: 'absent', avatar: 'J' },
                { id: 4, name: 'Thomas P.', role: 'AP', shift: '10:00 - 18:30', status: 'present', avatar: 'T' },
            ]);
            const [showToast, setShowToast] = useState(null);
            const [isSidebarOpen, setSidebarOpen] = useState(false);

            const handleFixAlert = () => {
                setShowToast({ message: "Analyse des profils...", type: "info" });
                
                setTimeout(() => {
                    setAlerts([]);
                    
                    const newStaff = staff.map(p => 
                        p.id === 3 ? { ...p, name: 'Clara D. (Interim)', status: 'present', shift: '14:00 - 18:00', avatar: 'C' } : p
                    );
                    setStaff(newStaff);

                    setStats(prev => ({
                        ...prev,
                        ratio: 5.8,
                        payroll: prev.payroll + 85
                    }));

                    setShowToast({ message: "Planning optimisé !", type: "success" });
                }, 1000);
            };

            return (
                <div className="flex h-screen w-full bg-slate-50">
                    {/* Sidebar Mobile Overlay */}
                    {isSidebarOpen && (
                        <div className="fixed inset-0 bg-black/50 z-40 lg:hidden" onClick={() => setSidebarOpen(false)}></div>
                    )}

                    {/* Sidebar */}
                    <aside className={`fixed lg:static inset-y-0 left-0 w-64 bg-white border-r border-slate-200 z-50 transform transition-transform duration-300 lg:transform-none ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full'} flex flex-col`}>
                        <div className="p-6 flex items-center gap-3">
                            <div className="w-8 h-8 bg-brand-navy rounded-lg flex items-center justify-center text-white font-display font-bold text-lg shadow-md">K</div>
                            <span className="font-display font-bold text-xl tracking-tight text-brand-navy">KidoPilot</span>
                        </div>

                        <div className="flex-1 px-4 py-6 space-y-2 overflow-y-auto">
                            <p className="px-4 text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2">Pilotage</p>
                            <SidebarItem icon="LayoutGrid" label="Tableau de bord" active={view === 'dashboard'} onClick={() => { setView('dashboard'); setSidebarOpen(false); }} alert={alerts.length > 0} />
                            <SidebarItem icon="CalendarClock" label="Planning" active={view === 'planning'} onClick={() => { setView('planning'); setSidebarOpen(false); }} />
                            <SidebarItem icon="Users" label="Enfants & Staff" />
                            
                            <div className="h-6"></div>
                            <p className="px-4 text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2">Conformité</p>
                            <SidebarItem icon="FileCheck" label="Audit PMI" />
                            <SidebarItem icon="Coins" label="CAF & PSU" />
                        </div>

                        <div className="p-4 border-t border-slate-100">
                            <div className="flex items-center gap-3 px-4 py-2">
                                <div className="w-8 h-8 rounded-full bg-brand-teal text-white flex items-center justify-center text-xs font-bold">CD</div>
                                <div className="flex-1">
                                    <p className="text-sm font-bold text-brand-navy">Claire D.</p>
                                    <p className="text-xs text-slate-500">Directrice</p>
                                </div>
                            </div>
                        </div>
                    </aside>

                    {/* Main Content */}
                    <main className="flex-1 flex flex-col h-screen overflow-hidden relative">
                        {/* Mobile Header */}
                        <div className="lg:hidden h-16 bg-white border-b border-slate-200 flex items-center justify-between px-4 z-30">
                            <button onClick={() => setSidebarOpen(true)} className="p-2 text-slate-600">
                                <Icon name="Menu" />
                            </button>
                            <span className="font-bold text-brand-navy">KidoPilot</span>
                            <div className="w-8"></div>
                        </div>

                        {/* Desktop Header */}
                        <header className="hidden lg:flex h-16 glass-panel items-center justify-between px-8 z-30">
                            <div className="flex items-center gap-4 text-sm text-slate-500">
                                <span className="font-bold text-brand-navy">Paris 17 - Batignolles</span>
                                <Icon name="ChevronDown" size={14} />
                            </div>
                            <div className="flex items-center gap-4">
                                <button className="p-2 relative text-slate-400 hover:text-brand-navy transition">
                                    <Icon name="Bell" size={20} />
                                    {alerts.length > 0 && <span className="absolute top-1.5 right-1.5 w-2 h-2 bg-brand-accent rounded-full border border-white"></span>}
                                </button>
                            </div>
                        </header>

                        {/* Content Area */}
                        <div className="flex-1 overflow-auto p-4 lg:p-8 relative">
                            {view === 'dashboard' && <DashboardView stats={stats} alerts={alerts} onFixAlert={() => setView('planning')} />}
                            {view === 'planning' && <PlanningView staff={staff} alerts={alerts} onFixAlert={handleFixAlert} />}
                        </div>
                    </main>

                    {/* Toast */}
                    {showToast && (
                        <Toast 
                            message={showToast.message} 
                            type={showToast.type} 
                            onClose={() => setShowToast(null)} 
                        />
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

